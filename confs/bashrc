#!/bin/bash

# bin
if [ -e ~/bin ]
then
    export PATH=~/bin:$PATH
fi

# pyenv
if [ -e ~/.pyenv ]
then
    export PYENV_ROOT="$HOME/.pyenv"
    export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
    eval "$(pyenv virtualenv-init -)"
fi

# workspace
WORKSPACE_IMAGE_PATH=$HOME/.workspace.dmg.sparseimage
if [ -f $WORKSPACE_IMAGE_PATH ]
then
    function workspacemount {
        hdiutil attach $WORKSPACE_IMAGE_PATH -mountpoint /Volumes/workspace;
        ln -s /Volumes/workspace ~/workspace
    }

    function workspaceumount {
        hdiutil detach /Volumes/workspace
        rm ~/workspace
    }
fi

# Nas NFS
NAS_MOUNT_PATH=$HOME/nas
function nasmount {
    if [ -e $NAS_MOUNT_PATH ]
    then
        echo 'Nas already mounted'
        return
    fi
    mkdir $NAS_MOUNT_PATH
    sudo mount -t nfs -o resvport,rw 192.168.1.99:/volume1/storage $NAS_MOUNT_PATH
}

function nasumount {
    if [ -e $NAS_MOUNT_PATH ] 
    then
        sudo umount $NAS_MOUNT_PATH
    fi
    rm -rf $NAS_MOUNT_PATH
}

# man
man() {
    env LESS_TERMCAP_mb=$'\E[01;31m' \
    LESS_TERMCAP_md=$'\E[01;38;5;74m' \
    LESS_TERMCAP_me=$'\E[0m' \
    LESS_TERMCAP_se=$'\E[0m' \
    LESS_TERMCAP_so=$'\E[38;5;246m' \
    LESS_TERMCAP_ue=$'\E[0m' \
    LESS_TERMCAP_us=$'\E[04;38;5;146m' \
    man "$@"
}

# translate man help page to pdf format
if [ `uname -s` = 'Darwin' ]
then
    function man2pdf {
        man -t $1 | open -f -a /Applications/Preview.app
    }
fi

# src_count
function src_count {
    type=$1
    total=0
    for x in `find ./* -type f -name "*.$type"`;
    do
        single=`cat $x|wc -l`
        total=$total+$single
    done

    echo $total|bc
}
